<!DOCTYPE html>
<html>
<head>
    <% include ../partials/head %>
</head>
<body class="container">
<script type="text/javascript">
			$(document).ready(function(){
					
				$('#matchAnlegen').submit(function(e) {
							e.preventDefault();
							$('.addid').html('');

							var datum = $('#datum').val();
							var uhrzeit = $('#uhrzeit').val();
							var teilnehmer1 = $('#teilnehmer1').val();
							var teilnehmer2 = $('#teilnehmer2').val();
							var teilnehmer3 = $('#teilnehmer3').val();
							var teilnehmer4 = $('#teilnehmer4').val();
							var austragungsort = $('#austragungsort').val();
							

							if(!(datum && uhrzeit && austragungsort)) {
								alert('Bitte Felder ausfÃ¼llen');
								return false;
								}
								
							if(!(teilnehmer1 || teilnehmer2 || teilnehmer3 || teilnehmer4)) {
								alert('Mindestens 1 Teilnehmer');
								return false;
							}


	var teilnehmerArray = [];
	
	if(teilnehmer1) {
		teilnehmerArray.push(teilnehmer1);
	}
	if(teilnehmer2) {
		teilnehmerArray.push(teilnehmer2);
	}
	if(teilnehmer3) {
		teilnehmerArray.push(teilnehmer3);
	}
	if(teilnehmer4) {
		teilnehmerArray.push(teilnehmer4);
	}
	
	console.log(teilnehmerArray);

	var formData = {
							Datum : datum,
						Uhrzeit : uhrzeit,
						Teilnehmer : teilnehmerArray,
						Austragungsort: austragungsort,
						Status: 'vor_beginn'}

							$.ajax({
								type: 'POST',
								contentType: 'application/json',
								url: '/Match/',
								
								data: JSON.stringify(formData),
								success: function(data) {
									 $('#matchAnlegen').each(function() {
                        this.reset();
                    });
						
							$('.addid').append('<a href="/Match/'+data.id+'">Match '+data.id+' angelegt</a>.');
									
								},
								statusCode: {
        400: function() {
           alert('Die Anfrage war nicht korrekt.');
        }
        },
        fail: function() {
	        alert('Fehler');
        }

							});
			
						});
		
			});
		</script>
		
    <header>
        <% include ../partials/header %>
    </header>

    <main>
        <div class="row">
            <div class="col-sm-8">
            
                <div class="jumbotron">
                    <h1>Add Match</h1>
                   

                   <form role="form" action="" method="POST" name="matchAnlegen" id="matchAnlegen">
                    <div class="form-group">
        <label for="teilnehmer">Teilnehmer 1:</label> <br>
        <input type="text" id="teilnehmer1" class="form-control" placeholder="Spieler 1" maxlength="100" /> 
          <label for="teilnehmer">Teilnehmer 2:</label> <br>
        <input type="text" id="teilnehmer2" class="form-control" placeholder="Spieler 2" maxlength="100" />
          <label for="teilnehmer">Teilnehmer 3:</label> <br>
        <input type="text" id="teilnehmer3" class="form-control" placeholder="Spieler 3" maxlength="100" />
          <label for="teilnehmer">Teilnehmer 4:</label> <br>
        <input type="text" id="teilnehmer4" class="form-control" placeholder="Spieler 4" maxlength="100" />
         </div>
          <div class="form-group">
		 <label for="datum">Datum:</label> <br>
        <input type="text" id="datum" class="form-control" placeholder="Datum" maxlength="100" />
         <label for="uhrzeit">Uhrzeit:</label> <br>
        <input type="text" id="uhrzeit" class="form-control" placeholder="Uhrzeit" maxlength="100" />
         <label for="austragungsort">Austragungsort:</label> <br>
        <input type="text" id="austragungsort" class="form-control" placeholder="Austragungsort" maxlength="100" />
         </div>
                <input type="submit" class="btn btn-primary" name="send" value="Absenden" />

        </form>
        <br />
        <p class="addid"></p>
                </div>
                
            </div>
           
        </div>
    </main>

    <footer>
        <% include ../partials/footer %>
    </footer>
    
</body>
</html>